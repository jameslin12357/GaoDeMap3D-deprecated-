<!DOCTYPE HTML>
<html>
<head>
    <meta name="viewport" content="width=device-width initial-scale=1.0 maximum-scale=1.0 user-scalable=0">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>3D地图</title>
    <style>
        body,html{ margin:0;padding:0;font:12px/16px Verdana,Helvetica,Arial,sans-serif;width: 100%;height: 100%}
        .container{
            height: 100%
        }
    </style>
    <link rel="stylesheet" href="./search.css">
    <script language="javascript" src="https://webapi.amap.com/maps?v=1.4.15&key=5a757297a2ef60c6c50aa13e4fb8f311&plugin=AMap.ControlBar"></script>

</head>
<body >
<div id="container" style="width:100%; height:100%;resize:both;"></div>
<button id="done">done</button>
<div id="coordsContainer"></div>
<script language="javascript">
    var map;
    function mapInit(){
        // "poiBounds":"",
        var buildingLayer = new AMap.Buildings({zIndex:130,merge:false,sort:false,zooms:[17,20]});
        var options =
            {
                hideWithoutStyle:false,//是否隐藏设定区域外的楼块
                areas:[{ //围栏1
                    //visible:false,//是否可见
                    rejectTexture:true,//是否屏蔽自定义地图的纹理
                    color1: 'ffffff00',//楼顶颜色
                    color2: 'ffffcc00',//楼面颜色
                    path: [[123.447478,41.793647],[123.447206,41.793643],[123.447216,41.793186],[123.448354,41.793201],[123.448294,41.793696],[123.447862,41.793688],[123.447879,41.793476],[123.447552,41.793472]]
                }
                ]
            };
        buildingLayer.setStyle(options); //此配色优先级高于自定义mapStyle


        var map = new AMap.Map("container", {
            zoom:17,
            pitch:50,
            showIndoorMap:false,
            showLabel:false,
            mapStyle:'amap://styles/light',
            center:[123.416223,41.815870],
            features:['bg','point','road'],
            viewMode:'3D',
            layers:[
                new AMap.TileLayer({}),
                buildingLayer
            ]
        });


        map.addControl(new AMap.ControlBar({
            showZoomBar:true,
            showControlButton:true,
            position:{
                right:'10px',
                top:'10px'
            }
        }));

        var marker = new AMap.Marker({
            position: new AMap.LngLat(123.416223,41.815870),   // 经纬度对象，也可以是经纬度构成的一维数组[116.39, 39.9]
            title: '北京'
        });

// 将创建的点标记添加到已有的地图实例：
        map.add(marker);
        map.on('click', function(ev) {
            // 触发事件的对象
            var target = ev.target;

            // 触发事件的地理坐标，AMap.LngLat 类型
            var lnglat = ev.lnglat;


            // 触发事件的像素坐标，AMap.Pixel 类型
            var pixel = ev.pixel;

            // 触发事件类型
            var type = ev.type;
            document.getElementById('coordsContainer').innerText += `[${lnglat.lng},${lnglat.lat}],`
            //console.log(`${lnglat.lng},${lnglat.lat}`);
        });


    }
    mapInit()
</script>
<script src="./search.js"></script>
</body>
</html>