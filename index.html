<!DOCTYPE HTML>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no, width=device-width">
    <style type="text/css">
        #container,html,body{
            height: 100%;
            margin:0;
        }
    </style>
    <title>3D楼块</title>
    <script language="javascript" src="https://webapi.amap.com/maps?v=1.4.15&key=5a757297a2ef60c6c50aa13e4fb8f311&plugin=Map3D,AMap.Scale"></script>
    <script language="javascript">
        function mapInit() {
            var buildingLayer = new AMap.Buildings({zIndex:130,merge:false,sort:false,zooms:[17,20]});
            // var bounds = [[123.412104,41.796251],[123.412667,41.796013],[123.413247,41.795772],[123.412915,41.795364],
            // [123.41265,41.795048],[123.412548,41.794934],[123.412379,41.794919],[123.411782,41.794827],[123.411121,41.79473],
            // [123.410679,41.794181],[123.410632,41.794135],[123.410543,41.794113],[123.409071,41.79468],[123.409435,41.795136],
            // [123.409858,41.795691],[123.410242,41.796212],[123.41044,41.796172],[123.410836,41.796196],[123.411042,41.796283],
            // [123.411241,41.796354],[123.411439,41.796521],[123.412104,41.796251]];
            var longlat = [123.411094,41.79536];
            // var bounds = [[123.409655,41.794485],[123.410548,41.794086],[123.411298,41.794808],[123.410009,41.795314]];
            // var bounds = [[123.413245,41.79579],[123.412539,41.794952],[123.410597,41.794147],[123.409118,41.79471],[123.410771,41.796301],[123.411182,41.794757]];

            var options =
                {
                    hideWithoutStyle:false,//是否隐藏设定区域外的楼块
                    areas:[
                    //     { //围栏1
                    //     //visible:false,//是否可见
                    //     rejectTexture:true,//是否屏蔽自定义地图的纹理
                    //     color1: 'ffffff00',//楼顶颜色
                    //     color2: 'ffffcc00',//楼面颜色
                    //     path: [[116.473606,39.995997],[116.473005,39.995482],[116.472442,39.994971],[116.472267,39.994801],[116.471307,39.995442],[116.471242,39.995446],[116.471163,39.995403],[116.4703,39.994639],[116.469916,39.994315],[116.469194,39.993719],[116.469032,39.993863],[116.468815,39.994108],[116.468625,39.994355],[116.468471,39.99466],[116.468421,39.994811],[116.468366,39.995156],[116.468306,39.996157],[116.468308,39.996557],[116.468483,39.996884],[116.468834,39.997188],[116.469481,39.997764],[116.470511,39.998708],[116.471404,39.999517],[116.471553,39.999568],[116.471713,39.999563],[116.471929,39.999463],[116.473228,39.998584],[116.474008,39.998046],[116.474541,39.997674],[116.474541,39.997576],[116.474604,39.997049],[116.474586,39.996895],[116.474179,39.996516],[116.473585,39.995997],[116.473606,39.995997]]
                    // }

                        { //围栏2
                        color1: 'ff99ff00',
                        color2: 'ff999900',
                        path: [[123.413188,41.795808],[123.411432,41.793682],[123.409096,41.794715],[123.410589,41.796899]]
                    }
                    ]

                };
            buildingLayer.setStyle(options); //此配色优先级高于自定义mapStyle


            var map = new AMap.Map("container", {
                zoom:17,
                pitch:50,
                showIndoorMap:false,
                showLabel:false,
                mapStyle:'amap://styles/light',
                center:[123.411094,41.79536],
                features:['bg','point','road'],
                viewMode:'3D',
                layers:[
                    new AMap.TileLayer({}),
                    buildingLayer
                ]
            });
            map.addControl(new AMap.Scale())
            // var path = [[116.473606,39.995997],[116.473005,39.995482],[116.472442,39.994971],[116.472267,39.994801],[116.471307,39.995442],[116.471242,39.995446],[116.471163,39.995403],[116.4703,39.994639],[116.469916,39.994315],[116.469194,39.993719],[116.469032,39.993863],[116.468815,39.994108],[116.468625,39.994355],[116.468471,39.99466],[116.468421,39.994811],[116.468366,39.995156],[116.468306,39.996157],[116.468308,39.996557],[116.468483,39.996884],[116.468834,39.997188],[116.469481,39.997764],[116.470511,39.998708],[116.471404,39.999517],[116.471553,39.999568],[116.471713,39.999563],[116.471929,39.999463],[116.473228,39.998584],[116.474008,39.998046],[116.474541,39.997674],[116.474541,39.997576],[116.474604,39.997049],[116.474586,39.996895],[116.474179,39.996516],[116.473585,39.995997],[116.473606,39.995997]];
            for (var i = 0; i < bounds.length; i++){
                var marker = new AMap.Marker({
                    position: new AMap.LngLat(bounds[i][0],bounds[i][1]),   // 经纬度对象，也可以是经纬度构成的一维数组[116.39, 39.9]
                    title: '北京'
                });
                map.add(marker);
            }
            var marker = new AMap.Marker({
                position: new AMap.LngLat(123.411094,41.79536),   // 经纬度对象，也可以是经纬度构成的一维数组[116.39, 39.9]
                title: '北京'
            });
            map.add(marker);


            map.on('click', function(ev) {
                // 触发事件的对象
                var target = ev.target;

                // 触发事件的地理坐标，AMap.LngLat 类型
                var lnglat = ev.lnglat;

                // 触发事件的像素坐标，AMap.Pixel 类型
                var pixel = ev.pixel;

                // 触发事件类型
                var type = ev.type;
                console.log(`${lnglat.lng},${lnglat.lat}`);
            });


// 将创建的点标记添加到已有的地图实例：

            // new AMap.Polygon({
            //     bubble:true,
            //     fillOpacity:0.4,
            //     strokeWeight:1,
            //     path:options.areas[0].path,
            //     map:map
            // })
            // new AMap.Polygon({
            //     bubble:true,
            //     fillColor:'green',
            //     fillOpacity:0.2,
            //     strokeWeight:1,
            //     path:options.areas[1].path,
            //     map:map
            // })
        }
    </script>
</head>
<body onload="mapInit();">
<div id="container" ></div>
</body>
</html>